
\title{Wave propagation and wavefield reconstruction in viscoelastic media}

\author{Tieyuan Zhu, The University of Texas at Austin}
\maketitle

\righthead{Viscoelastic wavefield reconstruction}

\begin{abstract}
This paper discusses the decoupled attenuation property of the viscoelastic wave equation. Because of the decoupling, wave propagation can be simulated in three scenarios: only amplitude loss effect, only phase dispersion effect, or both effects, which brings practical convenience, especially seismic inverse problems. Wavefield reconstruction can be accomplished simply by reversing the signs of both the P- and S-wave loss operators. Therefore, attenuation effects are thus compensated for during back-propagation. Several numerical examples are used to demonstrate the advantages of the decoupled attenuation property in both viscoelastic wave propagation and wavefield reconstruction. 
\end{abstract}

\section{Introduction}
Seismic wave propagation exhibits anelastic characteristics in real Earth materials. Particularly, in exploration geophysics the target areas (e.g., hydrocarbon reservoir) often show strong seismic attenuation (i.e., low quality factor, $Q$) caused by the presence of overpressured free gas accumulations (e.g., \citealt{carcione2003}; \citealt{dvorkin2006}). As a result, the recorded signals are significantly affected in amplitude and phase. Therefore, an accurate wavefield modeling approach should be able to account for the effects of attenuation and velocity dispersion. 

In the field of seismology, there have been two categories of approaches of viscoelastic simulations. One is based on the generalized Zener model and memory variables (e.g., \citealt{carcione1988}). The second approach is based on constant-$Q$ model given by \citet[]{kja79}, which has been shown to accurately describe the behavior of seismic waves in Pierre shale \cite[]{McDonal1958}. The resultant wave equation involves a fractional time derivative, i.e. an irrational (or non-integer) degree of the time derivative \cite[]{Caputo1971}. Although the Gr$\ddot{u}$nwald-Letnikov approximation \cite[]{Podlubny1999} can be used to compute this time derivative \cite[]{carcione2002,carcione2009}, its formulation requires to store in memory all previous values and is not practical in seismic modeling studies, in particular for three-dimensional simulations, even though it is possible to truncate the fractional operator after a given time period \cite[]{carcione2002}.

To avoid the memory requirements for the fractional time operators, \citet[]{zhu14c} derived a viscoelastic wave equation using fractional space derivatives. This operation, computed with the fractional Fourier pseudospectral method, avoids the storage of wavefields, making the modeling as efficient as the simulation in elastic media. To accurately compute the spatially varying power term of the fractional Laplacian operator, the lowrank approximation approach \citep{lowrank} is proposed for accurate viscoacoustic modeling and imaging \citep{sun14b}.

In this paper, I further illustrate the decoupled P- and S-wave attenuation property with the analysis of separated operators in the viscoelastic wave equation \cite[]{zhu14c}. I show that the first-derivative terms in the wave equation correspond to P- and S-wave amplitude loss and the remaining operators of the right-hand side correspond to dispersion. I test it using numerical simulations in a homogeneous model. For practicality in seismic inverse problems, I design a viscoelastic back-propagation approach that can correct for both P- and S-attenuation effects, which can be achieved by reversing the sign of both P- and S-attenuation operators. I demonstrate the applicability of the viscoelastic back-propagation approach with two synthetic models. 

\section{Viscoelastic wave propagation}
The frequency-independent $Q$ model (i.e., constant-$Q$ model) is considered to be a practical approximate $Q$ model for problems in exploration seismology. Based on the mathematically constant-$Q$ model \cite[]{kja79}, the 2-D velocity-stress formulation of the viscoelastic wave equation is given by \cite[]{zhu14c}
\begin{eqnarray}                  
\rho \partial _t\upsilon _1 &=& \left (  \partial _1 \sigma_{11}+\partial _3 \sigma_{13}+f_1\right ),\label{eq:eq1}\\                   
\rho \partial _t\upsilon _3 &=& \left (  \partial _1 \sigma_{13}+\partial_3 \sigma_{33}+f_3\right ),\label{eq:eq2}\\                  
\sigma _{11} &=& \left [ \eta _pB_p(\varepsilon_{11}+\varepsilon_{33} )-2\eta _sB_s\varepsilon_{33}  \right ] \nonumber \\
&+& \left [ \tau _pA_p\partial _t (\varepsilon_{11}+\varepsilon_{33} )-2\tau _sA_s\partial _t \varepsilon_{33} \right ],\label{eq:eq3} \\
\sigma _{33} &=& \left [ \eta _pB_p(\varepsilon_{11}+\varepsilon_{33} )-2\eta _sB_s\varepsilon_{11}  \right ] \nonumber \\
&+& \left [ \tau _pA_p\partial _t (\varepsilon_{11}+\varepsilon_{33} )-2\tau _sA_s\partial _t \varepsilon_{11} \right ],\label{eq:eq4}\\        
\sigma _{13} &=& \left [ 2\eta _sB_s\varepsilon_{13}+2\tau _sA_s\partial _t \varepsilon_{13} \right ],\label{eq:eq5}\\              
\epsilon _{11} &=& \partial _1 u_1,\epsilon _{33}=\partial _3 u_3,\epsilon _{13}=\frac{1}{2}\left ( \partial _3 u_1+\partial _1 u_3 \right ), \label{eq:eq6}
\end{eqnarray}
where $\rho$ is the mass density. $\upsilon$, $\sigma_i$, $\epsilon_{ij}$, and $f_i$ denote the particle velocity tensor, the stress tensor, the strain tensor and body force components, respectively. $u_i$ is the displacement and $\upsilon=\partial_tu_i$. $i$,$j$ are spatial indices (Einsteinâ€™s convention of repeated indices is assumed) and,
\begin{equation}
\label{eq:eq7}                      
\hspace{0pt} A_{P,S}=\left ( -\bigtriangledown^2  \right )^{\gamma _{P,S}-1/2},B_{P,S}=\left ( -\bigtriangledown^2  \right )^{\gamma _{P,S}},\hspace{\linewidth minus\linewidth}
\end{equation}
where
\begin{eqnarray}
\label{eq:eq8}
\tau_P = C_{\lambda} c_{P0}^{2\gamma_P-1}sin(\pi\gamma_P ),&& \eta_P=C_\lambda c_{P0}^{2\gamma_P}cos(\pi\gamma_P ),\nonumber \\
\tau_S = C_\mu c_{S0}^{2\gamma_S-1}sin(\pi\gamma_S ),&& \eta_S=C_\mu c_{S0}^{2\gamma_S}cos(\pi\gamma_S ),\nonumber \\
C_{\lambda}=M_{0}\omega_0^{-2\gamma_P}, && C_\mu=\mu_{0}\omega_0^{-2\gamma_S},
\end{eqnarray}
and $\omega_0$ is an arbitrary reference frequency, which should be higher than the source frequencies to guarantee pulse delay with respect to the lossless case. Also, $\gamma_{p,s}=\arctan(Q_{p,s}^{-1})/\pi $, and $0<\gamma_{p,s}<0.5$ for any positive value of $Q$, where  $Q_p$ and $Q_s$ are the P- and S-wave quality factors, respectively. The P-wave modulus $M_0$ and the S-wave modulus $\mu_0$  are given respectively by 
\begin{equation} 
 M_0=\rho c_{p0}^2\cos^2(\arctan(Q_p^{-1})/2) \nonumber
 \end{equation}
 and
 \begin{equation}
 \mu_0=\rho c_{s0}^2\cos^2(\arctan(Q_s^{-1})/2) \nonumber
\end{equation}
and $c_{p0}$ and $c_{s0}$ are the P- and S-wave velocities at the reference frequency, respectively. 

To solve the wave equation in inhomogeneous media (equations 1-5), I use the staggered-grid finite-difference approach to discretize the time derivatives and the staggered-grid pseudospectral approach to discretize the first-order spatial derivatives. The fractional Laplacian operators are solved by the fractional Fourier pseudospectral method as proposed by \citet[]{zhu14a}. 

Note that the first-order time-derivative terms in equations ~\ref{eq:eq3}, ~\ref{eq:eq4}, and ~\ref{eq:eq5} correspond to attenuation-associated P- and S-wave loss operators. When $Q_{p,s}\rightarrow \infty$   $(\gamma_{p,s}\rightarrow 0)$, the first-order time-derivative terms disappear, and equations 1-5 only contain second-order time derivatives, reducing to an elastic wave equation. 

To demonstrate decoupled amplitude loss and velocity dispersion for both P- and S-waves, I set up a homogeneous model with a vertical force source in the origin. $Q_p=30$ and $Q_s=15$. Figure 1a shows the snapshot of the elastic simulation with $Q_{p,s}\rightarrow \infty$. The P wavefront is labeled by the red dashed line while S wavefront is by a blue solid line. Figure 1b shows the amplitude-loss simulation (only smaller amplitude, no phase delay). Figure 1c shows the dispersion simulation (only phase delay, no loss).Figure 1d shows the viscoelastic simulation using equations 1-5 (smaller amplitude and phase delay).
\plot{Fig1}{width=0.45\textwidth}{Wavefield snapshots using (a)elastic; (b) amplitude-loss; (c) dispersive; (d)viscoelastic; The elastic P wavefront is labeled by the red dashed line while elastic S wavefront is by blue line. They are projected in all subfigures for comparisons of P- and S-wave phases.}

\section{Viscoelastic wavefield reconstruction}
To implement back propagation in the time-domain wave equation, I first replace time $t$ by $-t$. Due to attenuation during forward propagation, The amplitude during the propagation of time-reversed wavefields needs to be amplified. The amplification of amplitude is done by reversing the sign of the P-wave loss operator \cite[]{zhu14b}. For the viscoelastic case, I reverse the signs of both P- and S-wave loss operators. Assuming $\hat{t}=-t$ , the viscoelastic back propagation modeling equations with attenuation compensation can be written as
\begin{eqnarray}                   
\sigma_{11} &=&\left [ \eta _pB_p(\varepsilon_{11}+\varepsilon_{33} )-2\eta _sB_s\varepsilon_{33}  \right ] \nonumber \\
&-&\left [ \tau _pA_p\partial _t (\varepsilon_{11}+\varepsilon_{33} )-2\tau _sA_s\partial _t \varepsilon_{33} \right ],\label{eq:eq9}\\        
\sigma _{33} &=&\left [ \eta _pB_p(\varepsilon_{11}+\varepsilon_{33} )-2\eta _sB_s\varepsilon_{11}  \right ] \nonumber \\
&-&\left [ \tau _pA_p\partial _t (\varepsilon_{11}+\varepsilon_{33} )-2\tau _sA_s\partial _t \varepsilon_{11} \right ],\label{eq:eq10}\\
\sigma _{13} &=&2\eta _sB_s\varepsilon_{13} - 2\tau _sA_s\partial _t \varepsilon_{13}.\label{eq:eq11}
\end{eqnarray}
Substituting equations~\ref{eq:eq9},~\ref{eq:eq10},and ~\ref{eq:eq11} into equation ~\ref{eq:eq1} and ~\ref{eq:eq2} (with $\hat{t}=-t$), we can see that the solution  $\upsilon(\mathbf{x},-t)$ of equations  ~\ref{eq:eq1}, ~\ref{eq:eq2},~\ref{eq:eq9},~\ref{eq:eq10}, and~\ref{eq:eq11} is the time-reversed version of the solution $\upsilon(\mathbf{x},t)$  of the forward modeling equations (1-5), where $\mathbf{x}=(x,y,z)$. Simply, the waveform at a forward time t is physically equivalent to that at the reversed time $-t$. Therefore, the above system for time-reverse modeling becomes time-invariant.
For the reverse modeling, the input data consist of two particle velocity components (vertical $\upsilon_3$ and horizontal $\upsilon_1$). No body force is present throughout the time-reversal propagation, i.e., $f_i=0$ . The recorded particle velocity components are reversed in time and enforced as the Dirichlet boundary condition at receivers; mathematically, expressed as
\begin{eqnarray}
\label{eq:eq12}  
 \upsilon_1(\mathbf{x}_r,-t)=\upsilon_1 (T-t),\\
\upsilon_3(\mathbf{x}_r,t)=\upsilon_3 (T-t).
\end{eqnarray}
Here $T$ is the total recorded time and $\mathbf{x}_r=(x_r,z_r)$ is the receiver location in 2-D.

In practice, the higher frequencies in the recorded data are invariably contaminated by noise. Attenuation compensation during back propagation will amplify such unwanted frequency content. however, to prevent high-frequency noise from growing exponentially, I apply a low-pass filter in the spatial frequency domain to the right-hand-side attenuation-associated loss and dispersion operators in equations~\ref{eq:eq9}, ~\ref{eq:eq10}, and ~\ref{eq:eq11} when calculating the back-propagated wavefields. Note that, to avoid a loss of accuracy, the filter should not be applied to the propagation operators themselves \cite[]{zhu15a}. 
\plot{Fig2}{width=0.3\textwidth}{The source-receiver geometry for the first and second numerical experiments. The red star at the origin indicates the source. The open triangles indicate the receiver boundary. The filled triangles indicated two reference points. This example is in two dimensions. The coordinates of A and B are $(150, 100)$ m and $(-150, -200)$ m. Every tenth receiver is shown for clarity.}
\plot{Fig3}{width=0.4\textwidth}{Waveforms (horizontal particle velocity component) recorded at the reference points A (top) and B (bottom). Red: waveform recorded in the forward simulation using viscoelastic forward modeling. Green: waveform reconstructed by elastic back-propagation. Blue: waveform reconstructed by viscoelastic back-propagation in this paper. The recovery of the waveform (blue) demonstrates that the equation for the viscoelastic back-propagation approach is time-invariant. The errors may be caused by the finite-difference discretization. Labels â€˜Pâ€™ and â€˜Sâ€™ denote P-wave and S-wave, respectively.}

\section{Synthetic examples}
%\subsection{Wavefield reconstruction by viscoelastic TR}
The first example is a 2D homogeneous model. The P-wave velocity is $2500$ m/s, the S-wave velocity is $1500$ m/s, the density is $2200$ kg/m$^3$, $Q_p=40$, and $Q_s=20$. The model is discretized with $256\times 256$ grid points. The grid spacing of the horizontal and vertical axes are $\Delta x=\Delta z=6$ m. The source is at the origin point. Its center frequency is $25$ Hz with a time delay of $0.04$ s. The time step is 1 ms. The horizontal and vertical particle velocities are recorded through time with $400$ receivers, which are located in a circle with radius $600$ m centered at the source (Figure~\ref{fig:Fig2}).
%%=======
%\multiplot{2}{Fig2,Fig3}{width=0.3\textwidth}{The source-receiver geometry for the first and second numerical experiments. The red star at the origin indicates the source. The %open triangles indicate the receiver boundary. The filled triangles indicated two reference points. This example is in two dimensions. The coordinates of A and B are $(150, 100)%$ m and $(-150, -200)$ m. Every tenth receiver is shown for clarity.}

I generated synthetic viscoelastic data with a horizontal single force and subsequently implemented both elastic and viscoelastic back-propagation processes. The Tukey filter was chosen with a cutoff frequency of $120$ Hz and a taper ratio of $0.4$. Elastic back-propagation with simulated elastic data without any attenuation effects is also shown for reference. 
 
In the first test, I show the time-invariance of the viscoelastic back propagation approach, proving that the waveform at a specified point in the computational grid can be reconstructed during viscoelastic back propagation propagation. Here, I have two reference points A and B for all simulations in Figure~\ref{fig:Fig2}. 

Figure~\ref{fig:Fig3} shows reconstructed waveforms at reference points A and B. Due to attenuation between the reference points and receivers, the waveform reconstructed by elastic back propagation (green line) is spread out (phase-shifted) and has reduced amplitude at both A and B compared to the reference waveform (red line). We can see that the more attenuated S-waves exhibit larger shifts than the P-waves. Those incorrect waveforms at A and B reinforce the fact that the attenuation breaks the time-invariance of back propagation. The reconstructed waveform by viscoelastic back propagation with attenuation compensation (blue line) is comparable to the reference waveform in amplitude and phase for both P- and S-waves. The recovery of the waveform demonstrates the time-invariance of the viscoelastic wave equation for back propagation. 

I the next example, I use a truncated Marmousi model. Figure 4 shows the quality factor $Q$ in a $3\times 3$ km region of the Marmousi model \citep{versteeg1993}. For simplicity, the quality factor $Q$ is defined as the square root of P-wave velocity. The model is discretized with $256\times 256$ grid points. The grid spacing of the horizontal and vertical axes are $\Delta x=\Delta z=12.5$  m. The red star represents a source at the location (0 300) m. Its center frequency is 20 Hz with a time delay of 0.04 s. The time step is $5.4e-4$ s. Two arbitrary reference points $X_A$ and $X_B$ are shown in the solid triangles. The open triangles denote a receiver line with 193 receivers. Every tenth receiver location is marked by an open triangle. The total time length of seismograms is 1.6 s.

In Figure 5, the reference propagated waveforms at the $X_A$ (top) and $X_B$ (bottom) points in red are directly computed by viscoelastic modeling from the source. The reconstructed Greenâ€™s function using an acoustic time-reversal modeling method (green) and the viscoelastic back propagation modeling method (blue) are shown in both plots. Without attenuation compensation, there exists apparent difference in phase and amplitude compared to a reference solution (in red). With compensation, the reconstructed waveform show the excellent match in both amplitude and phase with the reference solutions, even at late times (Figure 5). These artifacts arrived before the primary waves are caused by scatterings after the arrivals of the primary waves during back propagation. 

\plot{Fig4}{width=0.4\textwidth}{Marmousi heterogeneous $Q_p$ model. The color scale indicates the P-wave quality factor. The model is bounded by absorbing boundary conditions on the four sides. The star represents a source. The two reference points $X_A$ and $X_B$ are used for comparisons of the waveforms. Every twentieth receiver on the surrounding surface S is marked by an open triangle.}

\section{Conclusion}
I presented a constructive approach to wave propagation and wavefield reconstruction by back-propagation in viscoelastic media. With the analysis of decoupling attenuation operators in the viscoelastic wave equation, I demonstrated that either amplitude loss or velocity dispersion can be independently enabled in viscoelastic wave propagation. Furthermore, the back propagation equation is formulated by reversing the sign of both P- and S-wave loss operators, which simultaneously compensates for both P- and S-wave attenuation effects in the reconstructed waveforms. Numerical results show that the viscoelastic back-propagation approach is able to reconstruct the waveform with correct phase and amplitude at an arbitrary point in the media. The proposed approach can potentially be used as a core engine of viscoelastic reverse-time migration and full-waveform inversion.

\section{Acknowledgements}
I would like to thank Jackson Postdoctoral Fellowship at the University of Texas at Austin for financial support. Comments by Sergey Fomel and Yanadet Sripanich help improve the clarity of the paper.

\plot{Fig5}{width=0.4\textwidth}{Reconstructed waveform and recorded at the reference points $X_A$ (a,b) and $X_B$ (c,d), respectively. The Vx and Vz components are reconstructed by elastic back-propagation (green) and by viscoelastic back-propagation (blue) compared to the reference solutions calculated by the viscoelastic forward modeling (red).}

\onecolumn

\bibliographystyle{seg}
\bibliography{ref032015}

